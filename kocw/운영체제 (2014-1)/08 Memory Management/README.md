# 08 Memory Management

> ğŸ§·Â Summary
- ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ ê´€ë¦¬ (ì£¼ì†Œë³€í™˜)ì— ëŒ€í•´ ë‹¤ë£¸
- CPUê°€ ë…¼ë¦¬ì  ì£¼ì†Œë¥¼ ì£¼ë©´ ë¬¼ë¦¬ì  ì£¼ì†Œë¡œ ë³€í™˜í•´ì„œ ë©”ëª¨ë¦¬ ì°¸ì¡°
- ì£¼ì†Œë³€í™˜ì—ì„œì˜ ìš´ì˜ì²´ì œì˜ ì—­í• ? ì—†ë‹¤. ëª¨ë‘ í•˜ë“œì›¨ì–´ê°€ ê´€ë¦¬
- ì™œ? ë§Œì•½ ì£¼ì†Œë³€í™˜ ë§ˆë‹¤ ìš´ì˜ì²´ì œê°€ ì—°ê´€ëœë‹¤ë©´ kernel â†’ user â†’ kernelì„ ë°˜ë³µí•´ì•¼í•¨. ëŒ€ì‹  I/O ì¥ì¹˜ ì ‘ê·¼ì‹œì— ìš´ì˜ì²´ì œì— ë„ì›€ì„ ìš”ì²­
> 

## Logical vs. Physical Address

- **Logical address** (=virtual address)
    - í”„ë¡œì„¸ìŠ¤ë§ˆë‹¤ ë…ë¦½ì ìœ¼ë¡œ ê°€ì§€ëŠ” ì£¼ì†Œ ê³µê°„
    - ê° í”„ë¡œì„¸ìŠ¤ë§ˆë‹¤ 0ë²ˆì§€ë¶€í„° ì‹œì‘
    - ğŸ“ŒÂ **CPUê°€ ë³´ëŠ” ì£¼ì†ŒëŠ” logical addressì„**
        - ì´ìœ : ì»´íŒŒì¼ì‹œ ë…¼ë¦¬ì£¼ì†Œë¡œ ë§µí•‘ëœ ì´í›„ ì‹¤í–‰ì´ ë˜ì–´ë„ instruction ì½”ë“œë‚´ì˜ ë…¼ë¦¬ì£¼ì†ŒëŠ” ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤.
- **Physical address**
    - ë©”ëª¨ë¦¬ì— ì‹¤ì œ ì˜¬ë¼ê°€ëŠ” ìœ„ì¹˜
- ì£¼ì†Œ ë°”ì¸ë”©: ì£¼ì†Œë¥¼ ê²°ì •í•˜ëŠ” ê²ƒ

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„’á…® 10.11.55.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_10.11.55.png)

## ì£¼ì†Œ ë°”ì¸ë”© (Address Binding)

![á„‹á…µá„†á…µá„Œá…µ 2023. 3. 1. á„‹á…©á„’á…® 10.17.jpg](src/%25E1%2584%258B%25E1%2585%25B5%25E1%2584%2586%25E1%2585%25B5%25E1%2584%258C%25E1%2585%25B5_2023._3._1._%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_10.17.jpg)

- Compile time binding
    - ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ ì£¼ì†Œ (physical address)ê°€ ì»´íŒŒì¼ ì‹œ ì•Œë ¤ì§
    - ì‹œì‘ ìœ„ì¹˜ ë³€ê²½ì‹œ ì¬ì»´íŒŒì¼
    - ì»´íŒŒì¼ëŸ¬ëŠ” ì ˆëŒ€ ì½”ë“œ (**absolute code**) ìƒì„±
- Load time binding
    - Load time binding
    - ì»´íŒŒì¼ëŸ¬ê°€ ì¬ë°°ì¹˜ ê°€ëŠ¥ ì½”ë“œ (**relocatable code**)ë¥¼ ìƒì„±í•œ ê²½ìš° ê°€ëŠ¥
- ğŸ“ŒÂ Execution time binding (= Run time binding)
    - ìˆ˜í–‰ì´ ì‹œì‘ëœ ì´í›„ì—ë„ í”„ë¡œì„¸ìŠ¤ì˜ ë©”ëª¨ë¦¬ ìƒ ìœ„ì¹˜ë¥¼ ì˜®ê¸¸ ìˆ˜ ìˆìŒ
    - CPUê°€ ì£¼ì†Œë¥¼ ì°¸ì¡°í•  ë•Œë§ˆë‹¤ bindingì„ ì ê²€ (address mapping table)
    - **í•˜ë“œì›¨ì–´ì ì¸ ì§€ì›ì´ í•„ìš”**
        - ì˜ˆ) base and limit registers, MMU

> ğŸ“Â ë©”ëª¨
ì»´íŒŒì¼ íƒ€ì„ ë°”ì¸ë”©ì—ì„œ ì£¼ì†Œë¥¼ ë³€ê²½í•˜ê³  ì‹¶ë‹¤ë©´ â†’ ì¬ ì»´íŒŒì¼
ëŸ° íƒ€ì„ ë°”ì¸ë”©ì€ ì£¼ì†Œê°€ ë°”ë€”ìˆ˜ ìˆê¸° ë•Œë¬¸ì— binding ì ê²€
> 

## Memory-Management Unit (MMU)

- **MMU (Memory-Management Unit)**
    - logical addressë¥¼ physical addressë¡œ ë§¤í•‘í•´ ì£¼ëŠ” Hardware device
- MMU scheme
    - ì‚¬ìš©ì í”„ë¡œì„¸ìŠ¤ê°€ CPUì—ì„œ ìˆ˜í–‰ë˜ë©° ìƒì„±í•´ë‚´ëŠ” ëª¨ë“  ì£¼ì†Œê°’ì— ëŒ€í•´ base register (= relocation register)ì˜ ê°’ì„ ë”í•œë‹¤
- user program
    - ğŸ“ŒÂ **logical address**ë§Œ ë‹¤ë£¬ë‹¤
    - ì‹¤ì œ physical addressë¥¼ ë³¼ ìˆ˜ ì—†ìœ¼ë©° ì•Œ í•„ìš”ê°€ ì—†ë‹¤

## Dynamic Relocation

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„’á…® 10.32.11.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_10.32.11.png)

- ë ˆì§€ìŠ¤í„° ë‘ ê°œ(relocation, limit register)ë¥¼ ì´ìš©í•´ì„œ ì£¼ì†Œë³€í™˜ì„ í•˜ê²Œ ëœë‹¤.
- í”„ë¡œê·¸ë¨ì˜ ë¬¼ë¦¬ì  ì‹œì‘ ìœ„ì¹˜ë¥¼ relocation registerì— ì €ì¥í•˜ê³  ì‚¬ìš©í•œë‹¤.
- í”„ë¡œê·¸ë¨ì˜ limit ê°’ì„ ì €ì¥í•˜ê³  ì‚¬ìš©í•˜ëŠ” ì´ìœ : limitì„ ë„˜ì–´ ê°€ëŠ” ì£¼ì†Œì— CPUê°€ ìš”ì²­ì„ í•˜ë©´ (ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ì´ ìœ„ì¹˜í•˜ëŠ” ë©”ëª¨ë¦¬) ì£¼ì§€ ì•Šê²Œí•œë‹¤.

## Hardware Support for Address Translation

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„’á…® 10.36.29.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_10.36.29.png)

- limitì— ë²—ì–´ë‚˜ëŠ” ìš”ì²­ì„ í•˜ë©´ CPU ì œì–´ê¶Œì´ OSë¡œ ë„˜ì–´ê°„ë‹¤.
- ìš´ì˜ì²´ì œ ë° ì‚¬ìš©ì í”„ë¡œì„¸ìŠ¤ ê°„ì˜ ë©”ëª¨ë¦¬ ë³´í˜¸ë¥¼ ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë ˆì§€ìŠ¤í„°
    - Relocation register(= base register): ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ ì£¼ì†Œì˜ ìµœì†Œê°’
    - Limit register: ë…¼ë¦¬ì  ì£¼ì†Œì˜ ë²”ìœ„

## Some Terminologies

- Dynamic Loading
- Dynamic Linking
- Overlays
- Swapping

## Dynamic Loading

> í”„ë¡œì„¸ìŠ¤ ì „ì²´ë¥¼ ë©”ëª¨ë¦¬ì— ë¯¸ë¦¬ ë‹¤ ì˜¬ë¦¬ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í•´ë‹¹ ë£¨í‹´ì´ ë¶ˆë ¤ì§ˆ ë•Œ ë©”ëª¨ë¦¬ì— load í•˜ëŠ” ê²ƒ
> 
- memory utilizationì˜ í–¥ìƒ
- ê°€ë”ì‹ ì‚¬ìš©ë˜ëŠ” ë§ì€ ì–‘ì˜ ì½”ë“œì˜ ê²½ìš° ìœ ìš©
    - ì˜ˆ) ì˜¤ë¥˜ ì²˜ë¦¬ ë£¨í‹´
- ìš´ì˜ì²´ì œì˜ íŠ¹ë³„í•œ ì§€ì› ì—†ì´ í”„ë¡œê·¸ë¨ ìì²´ì—ì„œ êµ¬í˜„ ê°€ëŠ¥ (OSëŠ” ğŸ“ŒÂ **ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ ì§€ì› ê°€ëŠ¥**)

## Overlays

- ë©”ëª¨ë¦¬ì— í”„ë¡œì„¸ìŠ¤ì˜ ë¶€ë¶„ ì¤‘ ì‹¤ì œ í•„ìš”í•œ ì •ë³´ë§Œì„ ì˜¬ë¦¼ (= Dynamic loading)
    - ì´ˆì°½ê¸° ì»´í“¨í„° ì‹œìŠ¤í…œì—ì„œ ë©”ëª¨ë¦¬ê°€ ì›Œë‚™ ì‘ì•˜ê¸° ë•Œë¬¸ì—, í° í”„ë¡œê·¸ë¨ì„ ìª¼ê°œì„œ ì˜¬ë ¤ì„œ ì‹¤í–‰ (ğŸ“Œìˆ˜ì‘ì—…)
- í”„ë¡œì„¸ìŠ¤ì˜ í¬í‚¤ê°€ ë©”ëª¨ë¦¬ë³´ë‹¤ í´ ë•Œ ìœ ìš©
- ìš´ì˜ì²´ì œì˜ ì§€ì›ì—†ì´ ì‚¬ìš©ìì— ì˜í•´ êµ¬í˜„
- ì‘ì€ ê³µê°„ì˜ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•˜ë˜ ì´ˆì°½ê¸° ì‹œìŠ¤í…œì—ì„œ ìˆ˜ì‘ì—…ìœ¼ë¡œ í”„ë¡œê·¸ë˜ë¨¸ê°€ êµ¬í˜„
    - Manual Overay
    - í”„ë¡œê·¸ë˜ë°ì´ ë§¤ìš° ë³µì¡

## Swapping

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„’á…® 10.59.15.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_10.59.15.png)

- **Swapping**
    - í”„ë¡œì„¸ìŠ¤ë¥¼ ì¼ì‹œì ìœ¼ë¡œ ë©”ëª¨ë¦¬ì—ì„œ **backing store**ë¡œ ì«“ì•„ë‚´ëŠ” ê²ƒ
- **Backing store (= swap area)**
    - ë””ìŠ¤í¬
        - ë§ì€ ì‚¬ìš©ìì˜ í”„ë¡œì„¸ìŠ¤ ì´ë¯¸ì§€ë¥¼ ë‹´ì„ ë§Œí¼ ì¶©ë¶„íˆ ë¹ ë¥´ê³  í° ì €ì¥ ê³µê°„
- **Swap in / Swap out**
    - ì¼ë°˜ì ìœ¼ë¡œ ğŸ“Œ**ì¤‘ê¸° ìŠ¤ì¼€ì¥´ëŸ¬** (swapper)ì— ì˜í•´ swap out ì‹œí‚¬ í”„ë¡œì„¸ìŠ¤ ì„ ì •
    - priority-based CPU scheduling algorithm
        - priorityê°€ ë‚®ì€ í”„ë¡œì„¸ìŠ¤ë¥¼ swapped out ì‹œí‚´
        - priorityê°€ ë†’ì€ í”„ë¡œì„¸ìŠ¤ë¥¼ ë©”ëª¨ë¦¬ì— ì˜¬ë ¤ ë†“ìŒ
    - Compile time í˜¹ì€ load time bindingì—ì„œëŠ” ì›ë˜ ë©”ëª¨ë¦¬ ìœ„ì¹˜ë¡œ swap in í•´ì•¼í•¨
    - ğŸ“ŒÂ Execution time bindingì—ì„œëŠ” ì¶”í›„ ë¹ˆ ë©”ëª¨ë¦¬ ì˜ì—­ ì•„ë¬´ ê³³ì—ë‚˜ ì˜¬ë¦´ ìˆ˜ ìˆìŒ
    - swap timeì€ ëŒ€ë¶€ë¶„ ğŸ“ŒÂ **transfer time** (swapë˜ëŠ” ì–‘ì— ë¹„ë¡€í•˜ëŠ” ì‹œê°„)ì„

## ğŸ“ŒÂ Dynamic Linking

> Linkingì„ ì‹¤í–‰ ì‹œê°„ (execution time)ê¹Œì§€ ë¯¸ë£¨ëŠ” ê¸°ë²•
> 
- Static linking
    - ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ íŒŒì¼ ì½”ë“œì— í¬í•¨ë¨
    - ì‹¤í–‰ íŒŒì¼ì˜ í¬ê¸°ê°€ ì»¤ì§
    - ë™ì¼í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°ê°ì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë©”ëª¨ë¦¬ì— ì˜¬ë¦¬ë¯€ë¡œ ë©”ëª¨ë¦¬ ë‚­ë¹„ (e.g., printf í•¨ìˆ˜ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì½”ë“œ)
- Dynamic linking
    - ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì‹¤í–‰ì‹œ ì—°ê²°(link)ë¨
    - ë¼ì´ë¸ŒëŸ¬ë¦¬ í˜¸ì¶œ ë¶€ë¶„ì— ë¼ì´ë¸ŒëŸ¬ë¦¬ ë£¨í‹´ì˜ ğŸ“ŒÂ **ìœ„ì¹˜ë¥¼ ì°¾ê¸° ìœ„í•œ stubì´ë¼ëŠ” ì‘ì€ ì½”ë“œ**ë¥¼ ë‘ 
    - ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì´ë¯¸ ë©”ëª¨ë¦¬ì— ìˆìœ¼ë©´ ê·¸ ë£¨í‹´ì˜ ì£¼ì†Œë¡œ ê°€ê³ , ì—†ìœ¼ë©´ ë””ìŠ¤í¬ì—ì„œ ì½ì–´ì˜´
        - shared library
    - ìš´ì˜ì²´ì œì˜ ë„ì›€ì´ í•„ìš”

## Allocation of Physcal Memory

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„’á…® 11.13.45.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_11.13.45.png)

- ë©”ëª¨ë¦¬ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë‘ ì˜ì—­ìœ¼ë¡œ ë‚˜ë‰˜ì–´ ì‚¬ìš©
    - **OS ìƒì£¼ ì˜ì—­**
        - interrupt vectorì™€ í•¨ê»˜ ë‚®ì€ ì£¼ì†Œ ì˜ì—­ ì‚¬ìš©
    - **ì‚¬ìš©ì í”„ë¡œì„¸ìŠ¤ ì˜ì—­**
        - ë†’ì€ ì£¼ì†Œ ì˜ì—­ ì‚¬ìš©
- ì‚¬ìš©ì í”„ë¡œì„¸ìŠ¤ ì˜ì—­ì˜ í• ë‹¹ ë°©ë²•
    - **Contiguous(= adjacent) allocation, ì—°ì† í• ë‹¹**
        - ê°ê°ì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë©”ëª¨ë¦¬ì˜ ì—°ì†ì ì¸ ê³µê°„ì— ì ì¬ë˜ë„ë¡ í•˜ëŠ” ê²ƒ
        - Fixed partition allocation
        - Variable partition allocation
    - **Noncontiguous allocation, ë¶ˆì—°ì† í• ë‹¹ (í˜„ëŒ€ì˜ ì‹œìŠ¤í…œ)**
        - í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë©”ëª¨ë¦¬ì˜ ì—¬ëŸ¬ ì˜ì—­ì— ë¶„ì‚°ë˜ì–´ ì˜¬ë¼ê°ˆ ìˆ˜ ìˆìŒ
        - Paging (ê°™ì€ í¬ê¸°ì˜ page ë‹¨ìœ„ë¡œ) â†’ ğŸ“Â ë§ì€ ë¬¸ì œë“¤ì´ í•´ê²°ë¨, but address bindingì´ ë³µì¡í•´ì§
        - Segmentation â†’ ğŸ“Â ì˜ë¯¸ìˆëŠ” ë‹¨ìœ„ë¡œ ìë¥´ëŠ”ê²ƒ (code, stack)
        - Paged Segmentation

## Contiguous Allocation

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„’á…® 11.17.52.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_11.17.52.png)

### ğŸ“‚Â Contiguous allocation (ì—°ì† í• ë‹¹)

- **ê³ ì • ë¶„í•  (Fixed partition) ë°©ì‹**
    - ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ë¥¼ ëª‡ ê°œì˜ ì˜êµ¬ì  ë¶„í•  (partition)ë¡œ ë‚˜ëˆ”
    - ë¶„í• ì˜ í¬ê¸°ê°€ ëª¨ë‘ ë™ì¼í•œ ë°©ì‹ê³¼ ì„œë¡œ ë‹¤ë¥¸ ë°©ì‹ì´ ì¡´ì¬
    - ë¶„í• ë‹¹ í•˜ë‚˜ì˜ í”„ë¡œê·¸ë¨ ì ì¬
    - ìœµí†µì„±ì´ ì—†ìŒ
        - ë™ì‹œì— ë©”ëª¨ë¦¬ loadë˜ëŠ” í”„ë¡œê·¸ë¨ì˜ ìˆ˜ê°€ ê³ ì •ë¨
        - ìµœëŒ€ ìˆ˜í–‰ ê°€ëŠ¥ í”„ë¡œê·¸ë¨ í¬ê¸° ì œí•œ
    - Internal fragmentation ë°œìƒ (external fragmentationë„ ë°œìƒ)
- **ê°€ë³€ ë¶„í•  (variable partition) ë°©ì‹**
    - í”„ë¡œê·¸ë¨ì˜ í¬ê¸°ë¥¼ ê³ ë ¤í•´ì„œ í• ë‹¹
    - ë¶„í• ì˜ í¬ê¸°, ê°œìˆ˜ê°€ ë™ì ìœ¼ë¡œ ë³€í•¨
    - ê¸°ìˆ ì  ê´€ë¦¬ ê¸°ë²• í•„ìš”
    - External fragmentation ë°œìƒ

> External fragmentation (ì™¸ë¶€ ì¡°ê°)
- í”„ë¡œê·¸ë¨ í¬ê¸°ë³´ë‹¤ ë¶„í• ì˜ í¬ê¸°ê°€ ì‘ì€ ê²½ìš°
- ì•„ë¬´ í”„ë¡œê·¸ë¨ì—ë„ ë°°ì •ë˜ì§€ ì•Šì€ ë¹ˆ ê³³ì¸ë°ë„ í”„ë¡œê·¸ë¨ì´ ì˜¬ë¼ê°ˆ ìˆ˜ ì—†ëŠ” ì‘ì€ ë¶„í• 

Internal fragmentation (ë‚´ë¶€ ì¡°ê°)
- í”„ë¡œê·¸ë¨ í¬ê¸°ë³´ë‹¤ ë¶„í• ì˜ í¬ê¸°ê°€ í° ê²½ìš°
- í•˜ë‚˜ì˜ ë¶„í•  ë‚´ë¶€ì—ì„œ ë°œìƒí•˜ëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ë©”ëª¨ë¦¬ ì¡°ê°
- íŠ¹ì • í”„ë¡œê·¸ë¨ì— ë°°ì •ë˜ì—ˆì§€ë§Œ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ê³µê°„
> 

### ğŸ“‚Â **Hole**

- ê°€ìš© ë©”ëª¨ë¦¬ ê³µê°„
- ë‹¤ì–‘í•œ í¬ê¸°ì˜ holeë“¤ì´ ë©”ëª¨ë¦¬ ì—¬ëŸ¬ ê³³ì— í©ì–´ì ¸ ìˆìŒ
- í”„ë¡œì„¸ìŠ¤ê°€ ë„ì°©í•˜ë©´ ìˆ˜ìš©ê°€ëŠ¥í•œ holeì„ í• ë‹¹
- ìš´ì˜ì²´ì œëŠ” ë‹¤ìŒì˜ ì •ë³´ë¥¼ ìœ ì§€
    - í• ë‹¹ ê³µê°„
    - ê°€ìš© ê³µê°„ (hole)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„’á…® 11.28.27.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_11.28.27.png)

### ğŸ“‚Â **Dynamic Storage-Allocation Problem**

: ê°€ë³€ ë¶„í•  ë°©ì‹ì—ì„œ size nì¸ ìš”ì²­ì„ ë§Œì¡±í•˜ëŠ” ê°€ì¥ ì ì ˆí•œ holeì„ ì°¾ëŠ” ë¬¸ì œ

- **First-fit**
    - sizeê°€ n ì´ìƒì¸ ê²ƒ ì¤‘ ìµœì´ˆë¡œ ì°¾ì•„ì§€ëŠ” holeì— í• ë‹¹
- **Best-fit**
    - sizeê°€ n ì´ìƒì¸ ê°€ì¥ ì‘ì€ holeì„ ì°¾ì•„ì„œ í• ë‹¹ â† í”„ë¡œê·¸ë¨ í¬ê¸°ì™€ ê°€ì¥ ë¹„ìŠ·í•œ
    - Hole ë“¤ì˜ ë¦¬ìŠ¤íŠ¸ê°€ í¬ê¸°ìˆœìœ¼ë¡œ ì •ë ¬ë˜ì§€ ì•Šì€ ê²½ìš° ëª¨ë“  holeì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ íƒìƒ‰í•´ì•¼í•¨
    - ë§ì€ ìˆ˜ì˜ ì•„ì£¼ ì‘ì€ holeë“¤ì´ ìƒì„±ë¨
- **Worst-fit**
    - ê°€ì¥ í° holeì— í• ë‹¹
    - ì—­ì‹œ ëª¨ë“  ë¦¬ìŠ¤íŠ¸ë¥¼ íƒìƒ‰í•´ì•¼ í•¨
    - ìƒëŒ€ì ìœ¼ë¡œ ì•„ì£¼ í° holeë“¤ì´ ìƒì„±ë¨

> First-fitê³¼ best-fitì´ worst-fit ë³´ë‹¤ ì†ë„ì™€ ê³µê°„ ì´ìš©ë¥  ì¸¡ë©´ì—ì„œ íš¨ê³¼ì ì¸ ê²ƒìœ¼ë¡œ ì•Œë ¤ì§ (ì‹¤í—˜ì ì¸ ê²°ê³¼)
> 

### ğŸ“‚Â **Compaction**

- External fragmentation ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” í•œ ê°€ì§€ ë°©ë²•
- ì‚¬ìš© ì¤‘ì¸ ë©”ëª¨ë¦¬ ì˜ì—­ì„ í•œêµ°ë°ë¡œ ëª°ë¡œ holeë“¤ì„ ë‹¤ë¥¸ í•œ ê³³ìœ¼ë¡œ ëª°ì•„ í° blockì„ ë§Œë“œëŠ”ê²ƒ
- ë§¤ìš° ë¹„ìš©ì´ ë§ì´ ë“œëŠ” ë°©ë²•ì„
- ìµœì†Œí•œì˜ ë©”ëª¨ë¦¬ ì´ë™ìœ¼ë¡œ compactioní•˜ëŠ” ë°©ë²• (ë§¤ìš° ë³µì¡í•œ ë¬¸ì œ)
- Compactionì€ í”„ë¡œì„¸ìŠ¤ì˜ ì£¼ì†Œê°€ **ì‹¤í–‰ ì‹œê°„ì— ë™ì **ìœ¼ë¡œ ì¬ë°°ì¹˜ ê°€ëŠ¥í•œ ê²½ìš°ì—ë§Œ ìˆ˜í–‰ë  ìˆ˜ ìˆë‹¤.

## ğŸ“ŒÂ Paging

### ğŸ“‚Â **Paging**

- Processì˜ virtual memoryë¥¼ ë™ì¼í•œ ì‚¬ì´ì¦ˆì˜ page ë‹¨ìœ„ë¡œ ë‚˜ëˆ”
- Virtual memoryì˜ ë‚´ìš©ì´ page ë‹¨ìœ„ë¡œ **noncontiguous**í•˜ê²Œ ì €ì¥ë¨
- ì¼ë¶€ëŠ” backing storageì—, ì¼ë¶€ëŠ” physical memoryì— ì €ì¥

### ğŸ“‚Â **Basic Method**

- Physical memoryë¥¼ ë™ì¼í•œ í¬ê¸°ì˜ **frame**ìœ¼ë¡œ ë‚˜ëˆ”
- logical memoryë¥¼ ë™ì¼í•œ í¬ê¸°ì˜ **page**ë¡œ ë‚˜ëˆ” (frameê³¼ ê°™ì€ í¬ê¸°)
- ëª¨ë“  ê°€ìš© frameë“¤ì„ ê´€ë¦¬
- **page table**ì„ ì‚¬ìš©í•˜ì—¬ logical addressë¥¼ physical addressë¡œ ë³€í™˜
    - ë°°ì—´ì„ table ì´ë¼ê³  í•¨. entry (index) â€œ*3ë²ˆ í˜ì´ì§€ëŠ” 7ë²ˆ í˜ì´ì§€ í…Œì´ë¸”ì— ì˜¬ë¼ê°€ ìˆë‹¤.*â€
- External fragmentation ë°œìƒ ì•ˆí•¨
- Internal fragmentation ë°œìƒ ê°€ëŠ¥

### ğŸ“‚Â **Paging Example**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 9.20.19.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.20.19.png)

- ì‹¤ì œë¡œëŠ” ì£¼ì†Œê³µê°„ì´ ë°±ë§Œê°œë¥¼ í•„ìš”ë¡œ í•œë‹¤ â†’ CPU ë ˆì§€ìŠ¤í„°ì— ë“¤ì–´ê°ˆ ìˆ˜ ì—†ë‹¤
- í˜ì´ì§€ í…Œì´ë¸”ì„ ë©”ëª¨ë¦¬ì— ë„£ê²Œ ë˜ì—ˆë‹¤.
- ğŸ“ŒÂ logical address â†’ page address â†’ index of page table â†’ value â†’ frame number

### **ğŸ“‚Â Implementation of Page Table**

- Page tableì€ main memoryì— ìƒì£¼
- **Page-table base register (PTBR)**ê°€ page tableì„ ê°€ë¦¬í‚´ â† ê¸°ì¡´ì˜ rellocation register
- **Page-table length register (PTLR)**ê°€ í…Œì´ë¸” í¬ê¸°ë¥¼ ë³´ê´€ â† ê¸°ì¡´ì˜ limit register
- ëª¨ë“  ë©”ëª¨ë¦¬ ì ‘ê·¼ ì—°ì‚°ì—ëŠ” 2ë²ˆì˜ memory access í•„ìš”
    - page table ì ‘ê·¼ 1ë²ˆ, ì‹¤ì œ data/instruction ì ‘ê·¼ 1ë²ˆ
- ì†ë„ í–¥ìƒì„ ìœ„í•´ associative register í˜¹ì€ translation look-aside buffer (**TLB**)ë¼ ë¶ˆë¦¬ëŠ” ê³ ì†ì˜ lookup hardware cache ì‚¬ìš©

### ğŸ“‚Â **Paging Hardware with TLB**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 9.35.17.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.35.17.png)

- ë¨¼ì € TLBë¥¼ ì²´í¬ â†’ ì¡´ì¬í•˜ë©´ â†’ í•œë²ˆë§Œ ì ‘ê·¼
- TLBì—ëŠ” ì¼ë¶€ë§Œ p, fìŒì„ ê°€ì§€ê³  ìˆë‹¤
- ì›ì¹™ëŒ€ë¡œë¼ë©´ ì „ì²´ë¥¼ search

### ğŸ“‚ **Associative Register**

- Associative register (TLB): parallel seachê°€ ê°€ëŠ¥
    - TLBì—ëŠ” page table ì¤‘ ì¼ë¶€ë§Œ ì¡´ì¬
- Address translation
    - page table ì¤‘ ì¼ë¶€ê°€ associative registerì— ë³´ê´€ë˜ì–´ ìˆìŒ
    - ë§Œì•½ í•´ë‹¹ page #ê°€ associative registerì— ìˆëŠ” ê²½ìš° ê³§ë°”ë¡œ frame #ë¥¼ ì–»ìŒ
    - ê·¸ë ‡ì§€ ì•ŠëŠ” ê²½ìš°(cache miss) main memoryì— ìˆëŠ” page tableë¡œ ë¶€í„° frame #ë¥¼ ì–»ìŒ
    - TLBëŠ” context switch ë•Œ flush (remove old entries)

### ğŸ“‚Â Effective Access Time

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 9.51.22.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.51.22.png)

### ğŸ“‚Â **Address Translation Architecture**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 9.24.40.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.24.40.png)

## ğŸ“ŒÂ Two-Level Page Table (2ì°¨ì› ë°°ì—´)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 9.52.41.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.52.41.png)

- ì™œ? ì†ë„ í˜¹ì€ ê³µê°„ì„ í–¥ìƒí•˜ê¸° ìœ„í•´ â†’ ê³µê°„ â†’ ì‚¬ì‹¤ ê³µê°„ë„ ë‚­ë¹„ â†’ ê·¸ëŸ¼ì—ë„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ”?
- ê°ê°ì˜ page í¬ê¸°ê°€ 4kb
- í˜„ëŒ€ì˜ ì»´í“¨í„°ëŠ” address spaceê°€ ë§¤ìš° í° í”„ë¡œê·¸ë¨ ì§€ì›
    - 32 bit address ì‚¬ìš©ì‹œ â†’ 2^32 B == 4GBì˜ ì£¼ì†Œê³µê°„
        - ê° page sizeê°€ 4KBì‹œ 1Mê°œì˜ page table entry í•„ìš”
        - ê° page entryê°€ 4Bì‹œ í”„ë¡œì„¸ìŠ¤ë‹¹ 4Mì˜ page table í•„ìš”
        - ê·¸ëŸ¬ë‚˜, ëŒ€ë¶€ë¶„ì˜ í”„ë¡œê·¸ë¨ì€ 4Gì˜ ì£¼ì†Œ ê³µê°„ ì¤‘ ì§€ê·¹íˆ ì¼ë¶€ë§Œ ì‚¬ìš©í•˜ë¯€ë¡œ page table ê³µê°„ì´ ì‹¬í•˜ê²Œ ë‚­ë¹„ë¨
    - ğŸ“ŒÂ page table ìì²´ë¥¼ pageë¡œ êµ¬ì„±
    - ğŸ“ŒÂ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì£¼ì†Œ ê³µê°„ì— ëŒ€í•œ outer page tableì˜ ì—”íŠ¸ë¦¬ ê°’ì€ NULL (ëŒ€ì‘í•˜ëŠ” inner page tableì´ ì—†ìŒ)

### ğŸ“‚Â **Address-Translation Scheme**

- 2ë‹¨ê³„ í˜ì´ì§•ì—ì„œì˜ Address-translation scheme
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 10.07.32.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_10.07.32.png)
    

### ğŸ“ŒÂ **Two-Level Paging Example (ì¤‘ìš”)**

- logical address (on 32-bit machine with 4K page size)ì˜ êµ¬ì„±
    - 20 bitì˜ page number
    - 12 bitì˜ page offset
- page table ìì²´ê°€ pageë¡œ êµ¬ì„±ë˜ê¸° ë•Œë¬¸ì— page numberëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë‚˜ë‰œë‹¤ (ê° page table entryê°€ 4B)
    - 10-bitì˜ page number
    - 10-bitì˜ page offset
- ë”°ë¼ì„œ, logical addressëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 10.12.55.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_10.12.55.png)
    
- P1ì€ outer page tableì˜ indexì´ê³ , ì•ˆë§Œë“¤ì–´ì§€ëŠ” pageì— ëŒ€í•´ null
- p2ëŠ” outer page tableì˜ pageì—ì„œì˜ ë³€ìœ„ (displacement)

> 4KB == 2^12B
> 

## Multi level Paging and Performance

- Address spaceê°€ ë” ì»¤ì§€ë©´ ë‹¤ë‹¨ê³„ í˜ì´ì§€ í…Œì´ë¸” í•„ìš”
- ê° ë‹¨ê³„ì˜ í˜ì´ì§€ í…Œì´ë¸”ì´ ë©”ëª¨ë¦¬ì— ì¡´ì¬í•˜ë¯€ë¡œ logical addressì˜ physical address ë³€í™˜ì— ë” ë§ì€ ë©”ëª¨ë¦¬ ì ‘ê·¼ í•„ìš”
- TLBë¥¼ í†µí•´ ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œê°„ì„ ì¤„ì¼ ìˆ˜ ìˆìŒ
- 4ë‹¨ê³„ í˜ì´ì§€ í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° â†’ 4ë²ˆ ì ‘ê·¼(ì£¼ì†Œë³€í™˜) + 1ë²ˆ ì‹¤ì œ ë°ì´í„° ì ‘ê·¼ = 5ë²ˆ
    - ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œê°„ì´ 100ns, TLB ì ‘ê·¼ ì‹œê°„ì´ 20nsì´ê³ 
    - TLB hit ratioê°€ 98%ì¸ ê²½ìš° (cache) â†’ ì§€ë‚˜ì¹˜ê²Œ ì˜¤ë˜ ê±¸ë¦¬ì§€ ì•ŠëŠ”ë‹¤
        - effective memory access time = 0.98 x 120 + 0.02 x 520 = 128 ns
        - ê²°ê³¼ì ìœ¼ë¡œ ì£¼ì†Œë³€í™˜ì„ ìœ„í•´ 28nsë§Œ ì†Œìš”

## Page Tableì— ë“¤ì–´ê°€ëŠ” bit ë‘ ê°€ì§€

### **ğŸ“‚Â Valid (v) / Invalid (i) Bit in a page Table**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 10.34.21.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_10.34.21.png)

- ì‹¤ì œë¡œ ë¶€ê°€ì ì¸ bitê°€ ë“¤ì–´ìˆìŒ
- 6, 7í˜ì´ì§€ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” í”„ë¡œê·¸ë¨ì´ì§€ë§Œ,  í˜ì´ì§€ í…Œì´ë¸”ì—ëŠ” maximum ì‚¬ì´ì¦ˆ ë§Œí¼ì˜ entryê°€ ìƒì„±
- ì¸ë±ìŠ¤ë¥¼ í†µí•´ ì ‘ê·¼ì„ í•´ì•¼í•˜ê¸° ë•Œë¬¸ â†’ ëŒ€ì‹  ì‚¬ìš©í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— i, v bitì„ ì´ìš©

### **ğŸ“‚Â Memory Protection**

- Page tableì˜ ê° entryë§ˆë‹¤ ì•„ë˜ì˜ bitë¥¼ ë‘”ë‹¤
    - **Protection bit â†’ ì—°ì‚°ì— ëŒ€í•œ ê¶Œí•œì„ í‘œê¸°**
        - pageì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œ (read/write/read-only)
    - **Valid-invalid bit**
        - â€œ**valid**â€ëŠ” í•´ë‹¹ ì£¼ì†Œì˜ frameì— ê·¸ í”„ë¡œì„¸ìŠ¤ë¥¼ êµ¬ì„±í•˜ëŠ” ìœ íš¨í•œ ë‚´ìš©ì´ ì‡ìŒì„ ëœ»í•¨ (ì ‘ê·¼ í—ˆìš©)
        - â€œ**invalid**â€ëŠ” í•´ë‹¹ ì£¼ì†Œì˜ frameì— ìœ íš¨í•œ ë‚´ìš©ì´ ì—†ìŒ*ì„ ëœ»í•¨ (ì ‘ê·¼ ë¶ˆí—ˆ)

* í”„ë¡œì„¸ìŠ¤ê°€ ê·¸ ì£¼ì†Œ ë¶€ë¶„ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°

** í•´ë‹¹ í˜ì´ì§€ê°€ ë©”ëª¨ë¦¬ì— ì˜¬ë¼ì™€ ìˆì§€ ì•Šê³  swap areaì— ìˆëŠ” ê²½ìš° 

## â“Â Inverted Page Table

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 10.48.06.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_10.48.06.png)

- page tableì´ ë§¤ìš° í° ì´ìœ 
    - ëª¨ë“  process ë³„ë¡œ ê·¸ logical addressì— ëŒ€ì‘í•˜ëŠ” ëª¨ë“  pageì— ëŒ€í•´ page table entryê°€ ì¡´ì¬
    - ëŒ€ì‘í•˜ëŠ” pageê°€ ë©”ëª¨ë¦¬ì— ìˆë“  ì•„ë‹ˆë“  ê°„ì— page tableì—ëŠ” entryë¡œ ì¡´ì¬
- Inverted page table
    - Page frame í•˜ë‚˜ë‹¹ page tableì— í•˜ë‚˜ì˜ entryë¥¼ ë‘” ê²ƒ (system-wide)
    - ê° page table entryëŠ” ê°ê°ì˜ ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ì˜ page frameì´ ë‹´ê³  ìˆëŠ” ë‚´ìš© í‘œì‹œ (process-id, processì˜ logical address)
    - ë‹¨ì 
        - í…Œì´ë¸” ì „ì²´ë¥¼ íƒìƒ‰í•´ì•¼í•¨ (ì‹œê°„ì  ì˜¤ë²„í—¤ë“œ)
    - ì¡°ì¹˜
        - associative register ì‚¬ìš© (expensive)

## Shared Page

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 10.56.01.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_10.56.01.png)

- shared code
    - **re-entrant code** (=pure code) â†’ ë‘ ê°€ì§€ ì¡°ê±´ì„ ë§Œì¡±
    - ğŸ“Œ **read-only**ë¡œ í•˜ì—¬ í”„ë¡œì„¸ìŠ¤ ê°„ì˜ í•˜ë‚˜ì˜ codeë§Œ ì˜¬ë¦¼
        - ì˜ˆ) text editors, compilers, window systems
    - shared codeëŠ” ëª¨ë“  í”„ë¡œì„¸ìŠ¤ì˜ ğŸ“ŒÂ **logical address spaceì—ì„œ ë™ì¼í•œ ìœ„ì¹˜**ì— ìˆì–´ì•¼ í•¨
        - ì™œ? ì»´íŒŒì¼ëœ ì½”ë“œë‚´ì˜ ì£¼ì†Œë“¤ (logical address)ì´ ë™ì¼í•´í•¨
- private code and data
    - ê° í”„ë¡œì„¸ìŠ¤ë“¤ì€ ë…ìì ìœ¼ë¡œ ë©”ëª¨ë¦¬ì— ì˜¬ë¦¼
    - Private dataëŠ” logical address spaceì˜ ì•„ë¬´ ê³³ì— ì™€ë„ ë¬´ë°©

## Segmentation

> â“Â Paging ê¸°ë²•ê³¼ ë‹¤ë¥¸ ì ?
> 
- í”„ë¡œê·¸ë¨ì€ ì˜ë¯¸ ë‹¨ìœ„ì¸ ì—¬ëŸ¬ ê°œì˜ segmentë¡œ êµ¬ì„±
    - ì‘ê²ŒëŠ” í”„ë¡œê·¸ë¨ì„ êµ¬ì„±í•˜ëŠ” í•¨ìˆ˜ í•˜ë‚˜í•˜ë‚˜ë¥¼ ì„¸ê·¸ë¨¼íŠ¸ë¡œ ì •ì˜
    - í¬ê²ŒëŠ” í”„ë¡œê·¸ë¨ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ì„¸ê·¸ë¨¼íŠ¸ë¡œ ì •ì˜ ê°€ëŠ¥
    - ì¼ë°˜ì ìœ¼ë¡œëŠ” `code`, `data`, `stack` ë¶€ë¶„ì´ í•˜ë‚˜ì”©ì˜ ì„¸ê·¸ë¨¼íŠ¸ë¡œ ì •ì˜ë¨
- segmentëŠ” ë‹¤ìŒê³¼ ê°™ì€ **logical unit** ë“¤ì„
    - main()
    - function
    - global variables
    - stack
    - symbol table, arrays

### **ğŸ“‚Â Architecture**

- logical addressëŠ” ë‹¤ìŒ ë‘ ê°€ì§€ë¡œ êµ¬ì„±
    - <segment-number, offset>
- segment table
    - each table entry has:
        - base - starting physical address of the segment
        - limit - length of the segment
- segment-table base register (STBR) â†’ base, limitê³¼ ë‹¤ë¥¸ ê°œë…?
    - ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ì—ì„œì˜ **segment tableì˜ ìœ„ì¹˜**
- segment-table length register (STLR) â†’ base, limitê³¼ ë‹¤ë¥¸ ê°œë…?
    - í”„ë¡œê·¸ë¨ì´ ì‚¬ìš©í•˜ëŠ” **segmentì˜ ìˆ˜**
        - segment number s is legal if s < STLR
- ğŸ“ŒÂ **Protection**
    - ê° ì„¸ê·¸ë¨¼íŠ¸ ë³„ë¡œ protection bitê°€ ìˆìŒ
    - each entry:
        - **valid** bit = 0 â‡’ illegal segment
        - **read / write / execution** ê¶Œí•œ bit â†’ ì˜ë¯¸ ë‹¨ìœ„ë¡œ ê¶Œí•œ ë¶€ì—¬ë¥¼ í•¨ â†’ êµ‰ì¥íˆ ìì—°ìŠ¤ëŸ¬ì›€
- **sharing**
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 11.48.18.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_11.48.18.png)
    
    - shared segment (ìœ„ ì˜ˆì œì—ì„œì˜ editorì— í•´ë‹¹í•˜ëŠ” code)
    - same segment number
    - segmentëŠ” ì˜ë¯¸ ë‹¨ìœ„ì´ê¸° ë•Œë¬¸ì— ê³µìœ  (sharing)ì™€ ë³´ì•ˆ(protection)ì— ìˆì–´ pagingë³´ë‹¤ í›¨ì”¬ íš¨ê³¼ì 
- **allocation (ì•½ì )**
    - first fit/ best fit
    - external fragmentation ë°œìƒ â†’ ğŸ“Â pagingì—ì„œëŠ” ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤
    - segmentì˜ ê¸¸ì´ê°€ ë™ì¼í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ê°€ë³€ë¶„í•  ë°©ì‹ì—ì„œì™€ ë™ì¼í•œ ë¬¸ì œì ë“¤ì´ ë°œìƒ

### ğŸ“‚Â **Hardware**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 11.07.02.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_11.07.02.png)

- ì£¼ì†Œ ë³€í™˜ì‹œ ë‘ ê°€ì§€ ì²´í¬
    - ì„¸ê·¸ë¨¼íŠ¸ ë²ˆí˜¸ê°€ ì‹¤ì œ ìˆ˜ë³´ë‹¤ í° ê²½ìš° â†’ ì˜ëª»ëœ ì‹œë„ (trap)
    - ì„¸ê·¸ë¨¼íŠ¸ì˜ ê¸¸ì´ê°€ 1000B ì¸ë° 2000Bë¥¼ ìš”êµ¬

### ğŸ“‚Â **Example**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 11.43.28.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_11.43.28.png)

- pagingì— ë¹„í•´ í˜ì´ì§€ ê°œìˆ˜ê°€ ìƒëŒ€ì ìœ¼ë¡œ ì ë‹¤ (tableì— ì˜í•œ ë©”ëª¨ë¦¬ ë‚­ë¹„)

## segmentation with paging

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-02 á„‹á…©á„Œá…¥á†« 11.51.59.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-02_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_11.51.59.png)

- pure segmentationê³¼ ì°¨ì´ì 
    - **segment-table entry**ê°€ segmentì˜ **base address**ë¥¼ ê°€ì§€ê³  ìˆëŠ” ê²ƒì´ ì•„ë‹ˆë¼ segmentë¥¼ êµ¬ì„±í•˜ëŠ” **page table**ì˜ **base address**ë¥¼ ê°€ì§€ê³  ìˆìŒ
    - ì¦‰, segmentë‹¹ page tableì„ ê°€ì§
    - pagingê³¼ segmentation ê¸°ë²•ì˜ ì¥ì ì„ ëª¨ë‘ ê°€ì§
        - allocation ë¬¸ì œê°€ ìƒê¸°ì§€ ì•ŠëŠ”ë‹¤ â†’ ì–´ì°¨í”¼ ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ì— pageë‹¨ìœ„ë¡œ ì˜¬ë¼ê°€ê¸° ë•Œë¬¸
        - ê³µìœ ë‚˜ ë³´ì•ˆ ê°™ì€ ì—…ë¬´ëŠ” segment table levelì—ì„œ ì´ë¤„ì§
    
    > d - segment offset: pageì•ˆì—ì„œ ì–¼ë§ˆë‚˜ ë–¨ì–´ì ¸ìˆëŠ”ì§€?
    >