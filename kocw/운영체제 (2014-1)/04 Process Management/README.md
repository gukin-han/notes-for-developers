# 04 Process Management

## í”„ë¡œì„¸ìŠ¤ ìƒì„± (Process Creation)

- ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ (a Parent process)ê°€ ìì‹ í”„ë¡œì„¸ìŠ¤ (children process) ğŸ“ŒÂ **ë³µì œ ìƒì„±**
    - Copy-on-write (COW) ê¸°ë²•: writeì´ ë°œìƒí• ë•Œ copyë¥¼ í•¨
- í”„ë¡œì„¸ìŠ¤ì˜ íŠ¸ë¦¬ (ê³„ì¸µ êµ¬ì¡°) í˜•ì„±
- í”„ë¡œì„¸ìŠ¤ëŠ” ìì›ì„ í•„ìš”ë¡œ í•¨
    - ìš´ì˜ì²´ì œë¡œë¶€í„° ë°›ëŠ”ë‹¤
    - ë¶€ëª¨ì™€ ê³µìœ í•œë‹¤
- ìì›ì„ ê³µìœ 
    - ë¶€ëª¨ì™€ ìì‹ì´ ëª¨ë“  ìì›ì„ ê³µìœ í•˜ëŠ” ëª¨ë¸
    - ì¼ë¶€ë¥¼ ê³µìœ í•˜ëŠ” ëª¨ë¸
    - ì „í˜€ ê³µìœ í•˜ì§€ ì•ŠëŠ” ëª¨ë¸ â† ğŸ“Â ì›ì¹™ì ìœ¼ë¡œëŠ” ê³µìœ í•˜ì§€ ì•ŠëŠ”ë‹¤ (ì¼ë°˜ì )
- ìˆ˜í–‰ (Execution)
    - ë¶€ëª¨ì™€ ìì‹ì€ ê³µì¡´í•˜ë©° ìˆ˜í–‰ë˜ëŠ” ëª¨ë¸
    - ìì‹ì´ ì¢…ë£Œ (terminate)ë  ë•Œê¹Œì§€ ë¶€ëª¨ê°€ ê¸°ë‹¤ë¦¬ëŠ” (wait; blocked) ëª¨ë¸
- ì£¼ì†Œ ê³µê°„ (Address space)
    - ìì‹ì€ ë¶€ëª¨ì˜ ê³µê°„ì„ ë³µì‚¬í•¨ (binary and OS data)
    - ìì‹ì€ ê·¸ ê³µê°„ì— ìƒˆë¡œìš´ í”„ë¡œê·¸ë¨ì„ ì˜¬ë¦¼
- ìœ ë‹‰ìŠ¤ ì˜ˆ
    - `fork()` ì‹œìŠ¤í…œ ì½œì´ ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ë¥¼ ìƒì„±
        - ë¶€ëª¨ë¥¼ ê·¸ëŒ€ë¡œ ë³µì‚¬ (OS data except PID + binary)
        - ì£¼ì†Œ ê³µê°„ í• ë‹¹
    - fork ë‹¤ìŒì— ì´ì–´ì§€ëŠ” `exec()` ì‹œìŠ¤í…œ ì½œì„ í†µí•´ ìƒˆë¡œìš´ í”„ë¡œê·¸ë¨ì„ ë©”ëª¨ë¦¬ì— ì˜¬ë¦¼

> ğŸ“ŒÂ ì—¬ê¸°ì„œ ë³µì œëŠ” ë¬¸ë§¥ì„ ë³µì œí•˜ëŠ” ê²ƒì„ ë§í•¨
> 

## í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ (Process Termination)

- í”„ë¡œì„¸ìŠ¤ê°€ ë§ˆì§€ë§‰ ëª…ë ¹ì„ ìˆ˜í–‰í•œ í›„ ìš´ì˜ì²´ì œì—ê²Œ ì´ë¥¼ ì•Œë ¤ì¤Œ (**`exit`**)
    - ìì‹ì´ ë¶€ëª¨ì—ê²Œ output dataë¥¼ ë³´ëƒ„ (via `wait`)
    - í”„ë¡œì„¸ìŠ¤ì˜ ê°ì¢… ìì›ë“¤ì´ ìš´ì˜ì²´ì œì—ê²Œ ë°˜ë‚©ë¨
- ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ê°€ ìì‹ì˜ ìˆ˜í–‰ì„ ì¢…ë£Œì‹œí‚´ (`abort`)
    - ìì‹ì´ í• ë‹¹ ìì›ì˜ í•œê³„ì¹˜ë¥¼ ë„˜ì–´ì„¬
    - ìì‹ì—ê²Œ í• ë‹¹ëœ íƒœìŠ¤í¬ê°€ ë” ì´ìƒ í•„ìš”ë¡œ í•˜ì§€ ì•ŠìŒ
    - ë¶€ëª¨ê°€ ì¢…ë£Œ (exit)í•˜ëŠ” ê²½ìš°
        - ìš´ì˜ì²´ì œëŠ” ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œí•˜ëŠ” ê²½ìš° ìì‹ì´ ë” ì´ìƒ ìˆ˜í–‰ë˜ë„ë¡ ë‘ì§€ ì•ŠëŠ”ë‹¤
        - ë‹¨ê³„ì ì¸ ì¢…ë£Œ

> ğŸ“Â Cì—ì„œ ë¬¸ì¥ ë§ˆì§€ë§‰ì— exitì„ ìë™ìœ¼ë¡œ ë„£ì–´ í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œ
> 

## í”„ë¡œì„¸ìŠ¤ì™€ ê´€ë ¨í•œ ì‹œìŠ¤í…œ ì½œ

- `fork()` - create a child (copy)
- `exec()` - overlay new image
- `wait()` - sleep until child is done
- `exit()` - frees all the resources, notify parent

## `fork()` ì‹œìŠ¤í…œ ì½œ

- A process is created by the `fork()` system call.
    - creates a new address space that is a duplicate of the caller.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„Œá…¥á†« 8.41.25.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_8.41.25.png)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„Œá…¥á†« 8.42.42.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_8.42.42.png)

- `fork()` ì´í›„ë¡œ ì‹¤í–‰ â†’ ë¬¸ë§¥(program counter)ì„ ë³µì‚¬í•˜ê¸° ë•Œë¬¸ì— ìì‹ ìì‹ ì€ ì´ë¯¸ `fork()`ë¥¼ ì‹¤í–‰í•œì¤„ ì•Œê³  ìˆë‹¤.
- PIDë¡œ ë³µì œë³¸ê³¼ ì›ë³¸ì„ êµ¬ë¶„í•¨

## `exec()` ì‹œìŠ¤í…œì½œ

- A process can execute a different program by the `exec()` system call
    - replaces the memory image of the caller with a new program.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„Œá…¥á†« 8.54.42.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_8.54.42.png)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„Œá…¥á†« 8.55.31.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_8.55.31.png)

- exec ì´í›„ ìƒˆë¡œìš´ ì½”ë“œë¡œ ì”Œì–´ì§€ê¸° ë•Œë¬¸ì— ë§ˆì§€ë§‰ ì¶œë ¥ë¬¸ì€ í•˜ì§€ ëª»í•œë‹¤.

## `wait()` ì‹œìŠ¤í…œ ì½œ

- í”„ë¡œì„¸ìŠ¤ Aê°€ `wait()` ì‹œìŠ¤í…œ ì½œì„ í˜¸ì¶œí•˜ë©´
    - ì»¤ë„ì€ childê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ í”„ë¡œì„¸ìŠ¤ Aë¥¼ sleepì‹œí‚¨ë‹¤ (blocked ìƒíƒœ)
    - Child processê°€ ì¢…ë£Œë˜ë©´ ì»¤ë„ì€ í”„ë¡œì„¸ìŠ¤ Aë¥¼ ê¹¨ìš´ë‹¤ (ready ìƒíƒœ)
        - blocked â†’ ready
        - ìì‹ì´ ì¢…ë£Œë ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” ëª¨ë¸

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„Œá…¥á†« 9.02.41.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.02.41.png)

## `exit()` ì‹œìŠ¤í…œ ì½œ

- í”„ë¡œì„¸ìŠ¤ì˜ ì¢…ë£Œ
    - ìë°œì  ì¢…ë£Œ
        - ë§ˆì§€ë§‰ statement ìˆ˜í–‰ í›„ `exit()` ì‹œìŠ¤í…œ ì½œì„ í†µí•´
        - í”„ë¡œê·¸ë¨ì— ëª…ì‹œì ìœ¼ë¡œ ì ì–´ì£¼ì§€ ì•Šì•„ë„ main í•¨ìˆ˜ê°€ ë¦¬í„´í•˜ëŠ” ìœ„ì¹˜ì— ì»´íŒŒì¼ëŸ¬ê°€ ë„£ì–´ì¤Œ
    - ë¹„ìë°œì  ì¢…ë£Œ
        - ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ê°€ ìì‹ í”„ë¡œì„¸ìŠ¤ë¥¼ ê°•ì œ ì¢…ë£Œì‹œí‚´
            - ìì‹ í”„ë¡œì„¸ìŠ¤ê°€ í•œê³„ì¹˜ë¥¼ ë„˜ì–´ì„œëŠ” ìì› ìš”ì²­
            - ìì‹ì—ê²Œ í• ë‹¹ëœ íƒœìŠ¤í¬ê°€ ë” ì´ìƒ í•„ìš”í•˜ì§€ ì•ŠìŒ
        - í‚¤ë³´ë“œë¡œ kill, break ë“±ì„ ì¹œ ê²½ìš°
        - ë¶€ëª¨ê°€ ì¢…ë£Œí•˜ëŠ” ê²½ìš°
            - ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œí•˜ê¸° ì „ì— ìì‹ë“¤ì´ ë¨¼ì € ì¢…ë£Œë¨

## í”„ë¡œì„¸ìŠ¤ ê°„ í˜‘ë ¥

- ë…ë¦½ì  í”„ë¡œì„¸ìŠ¤ (Independent process)
    - í”„ë¡œì„¸ìŠ¤ëŠ” ê°ìì˜ ì£¼ì†Œ ê³µê°„ì„ ê°€ì§€ê³  ìˆ˜í–‰ë˜ë¯€ë¡œ ì›ì¹™ì ìœ¼ë¡œ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ëŠ” ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì˜ ìˆ˜í–‰ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ëª»í•¨
- í˜‘ë ¥ í”„ë¡œì„¸ìŠ¤ (Cooperating process)
    - í”„ë¡œì„¸ìŠ¤ í˜‘ë ¥ ë©”ì»¤ë‹ˆì¦˜ì„ í†µí•´ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì˜ ìˆ˜í–‰ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŒ
- í”„ë¡œì„¸ìŠ¤ ê°„ í˜‘ë ¥ ë©”ì»¤ë‹ˆì¦˜ (IPC: Interprocess Communication)
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„Œá…¥á†« 9.19.55.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.19.55.png)
    
    - ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ë²•
        - **message passing**: ğŸ“ŒÂ **ì»¤ë„**ì„ í†µí•´ ë©”ì‹œì§€ ì „ë‹¬
    - ì£¼ì†Œ ê³µê°„ì„ ê³µìœ í•˜ëŠ” ë°©ë²•
        - **shared memory**: ì„œë¡œ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ ê°„ì—ë„ ì¼ë¶€ ì£¼ì†Œ ê³µê°„ì„ ê³µìœ í•˜ê²Œ í•˜ëŠ” shared memory ë©”ì»¤ë‹ˆì¦˜ì´ ìˆìŒ

> ğŸ“ŒÂ **thread**: threadëŠ” ì‚¬ì‹¤ìƒ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ì´ë¯€ë¡œ í”„ë¡œì„¸ìŠ¤ ê°„ í˜‘ë ¥ìœ¼ë¡œ ë³´ê¸°ëŠ” ì–´ë µì§€ë§Œ ë™ì¼í•œ processë¥¼ êµ¬ì„±í•˜ëŠ” threadë“¤ ê°„ì—ëŠ” ì£¼ì†Œ ê³µê°„ì„ ê³µìœ í•˜ë¯€ë¡œ í˜‘ë ¥ì´ ê°€ëŠ¥
> 

## Message Passing

- Message system
    - í”„ë¡œì„¸ìŠ¤ ì‚¬ì´ì— ê³µìœ  ë³€ìˆ˜ (shared variable)ë¥¼ ì¼ì²´ ì‚¬ìš©í•˜ì§€ ì•Šê³  í†µì‹ í•˜ëŠ” ì‹œìŠ¤í…œ
- Direct Communication
    - í†µì‹ í•˜ë ¤ëŠ” í”„ë¡œì„¸ìŠ¤ì˜ ì´ë¦„ì„ ëª…ì‹œì ìœ¼ë¡œ í‘œì‹œ
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„Œá…¥á†« 9.16.56.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.16.56.png)
        
- Indirect Communication
    - mailbox (ë˜ëŠ” port)ë¥¼ í†µí•´ ë©”ì‹œì§€ë¥¼ ê°„ì ‘ ì „ë‹¬
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-01 á„‹á…©á„Œá…¥á†« 9.17.38.png](src/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.17.38.png)